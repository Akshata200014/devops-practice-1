- name: Deploy to EC2 via SSH
        uses: appleboy/ssh-action@v0.1.10
        with:
          host: ${{ secrets.EC2_HOST }}
          username: ${{ secrets.EC2_USERNAME }}
          key: ${{ secrets.EC2_SSH_KEY }}
          script: |
            # 1. Navigate to the folder (Adjust 'devops-project' if the name is different!)
            # We use the absolute path /root/ if you were working as root, 
            # or ~/ if you moved it to the ubuntu user.
            cd ~/devops-project || cd ~/devops-assessment || exit 1
            
            # 2. Pull latest images (using sudo to avoid permission denied)
            sudo docker-compose pull
            
            # 3. Restart containers
            sudo docker-compose up -d --remove-orphans
            
            # 4. Clean up
            sudo docker image prune -f
